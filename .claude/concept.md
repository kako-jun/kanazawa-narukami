# 金沢は今日も鳴雷（なるかみ）- 構想

## 📋 プロジェクト概要

### コンセプト
金沢の曇り空と落雷をテーマにした、ブラウザで動作するリアルタイム雷予測ゲーム。

### 着想
- 金沢は日本でも曇りが多く、雷が発生しやすい気候
- 天気予報をゲーム化することで、気象への関心を高める
- ギャンブル要素とリアルタイムデータの組み合わせ

### コアアイデア
プレイヤーは次の5分間でどのエリアに雷が落ちるかを予測し、オッズに応じてポイントを獲得する。

## 🎯 ゲームの目的

### プレイヤー目標
- エリアを予測してポイントを増やす
- 高オッズエリアで的中させて大量ポイント獲得
- 履歴から傾向を読み、的中率を上げる

### デザイン目標
- 直感的で分かりやすいUI
- 金沢の雰囲気を表現（曇り空、雷光）
- リアルタイム性の演出

## 🎮 ゲームフロー

```
1. ゲーム開始（初期スコア: 1000pt）
   ↓
2. エリア選択（16エリアから1つ）
   ↓
3. ベット額決定（50/100/250/500pt）
   ↓
4. ベット確定
   ↓
5. カウントダウン待機（5分）
   ↓
6. 雷落下判定
   ↓
7. 結果表示
   - 的中 → オッズ×ベット額を獲得
   - 外れ → ベット額を失う
   ↓
8. 次のラウンドへ
```

## 🗺️ グリッドシステム

### エリア分割
- 金沢市を4×4の16エリアに分割
- エリアID: A1, A2, A3, A4, B1, B2, ..., D3, D4

### 地理的配置
```
    1    2    3    4
A  [A1] [A2] [A3] [A4]  北部
B  [B1] [B2] [B3] [B4]  中央北
C  [C1] [C2] [C3] [C4]  中央南
D  [D1] [D2] [D3] [D4]  南部
```

## 💰 オッズシステム

### 基本原則
- 落ちやすいエリア → オッズ低め（例: ×1.2）
- 落ちにくいエリア → オッズ高め（例: ×3.5）

### 計算式
```
オッズ = (1 / 確率) × 0.9
```

0.9はハウスエッジ（運営側の取り分）

### 確率の決定要因
- 雷雲の中心からの距離
- 過去の雷発生頻度
- 移動方向の予測

## ⚡ 雷データソース

### Phase 1: シミュレーション（現在）
- ランダムに雷雲の中心を決定
- 距離ベースで確率を計算
- ゲームロジックのテスト用

### Phase 2: 気象庁データ統合（予定）
- **データソース**: 気象庁「雷ナウキャスト」
- **取得方法**: 画像スクレイピング
- **解析方法**: Canvas APIで画像解析
- **更新頻度**: 5分ごと

## 🎨 ビジュアルデザイン

### カラースキーム
- **背景**: グレー系グラデーション（曇り空）
- **タイトル**: 青（#3498db）
- **アクセント**: 黄色（#f39c12）- オッズ、スコア
- **警告**: 赤（#e74c3c）- タイマー、外れ

### タイポグラフィ
- **タイトル**: Klee One（手書き風）、青、斜め（-2deg）
- **本文**: Klee One
- **数値**: 太字、大きめ

### エフェクト
1. **雷光フラッシュ**: 白の全画面フラッシュ（的中時）
2. **暗転**: 黒の全画面フェード（外れ時）
3. **パルスアニメーション**: 雷の落ちたエリアを強調
4. **雲の移動**: 背景の緩やかなアニメーション

## 🎵 サウンドデザイン（予定）

### 効果音
- **雷音**: ゴロゴロ音（落雷時）
- **ベット確定**: カチッ音
- **的中**: チャリーン音
- **外れ**: ブー音

### BGM
- 環境音（雨音、風音）を低音量でループ

## 📊 データ構造

### ゲーム状態
```javascript
{
  score: Number,           // 現在のスコア
  betAmount: Number,       // 現在のベット額
  selectedArea: String,    // 選択中のエリアID
  roundTime: Number,       // 残り秒数
  currentRound: Number,    // ラウンド番号
  isRoundActive: Boolean   // ラウンド中か
}
```

### エリア情報
```javascript
{
  id: String,              // エリアID (例: "A1")
  row: Number,             // 行番号 (0-3)
  col: Number,             // 列番号 (0-3)
  probability: Number,     // 雷の落ちる確率 (0.0-1.0)
  odds: Number             // オッズ倍率
}
```

### 履歴
```javascript
{
  round: Number,           // ラウンド番号
  isWin: Boolean,          // 的中したか
  selectedArea: String,    // 選択したエリア
  hitArea: String,         // 実際に落ちたエリア
  amount: Number,          // 獲得/損失ポイント
  timestamp: Date          // 日時
}
```

## 🚀 展開予定

### Phase 1: 基本実装（完了）
- ✅ UI/UX
- ✅ ゲームループ
- ✅ オッズ計算
- ✅ シミュレーション

### Phase 2: データ統合
- 🔄 気象庁データ取得
- 🔄 Canvas画像解析
- 🔄 リアルタイム確率更新

### Phase 3: 機能拡張
- 🔲 サウンドエフェクト
- 🔲 ランキングシステム
- 🔲 ソーシャル共有
- 🔲 統計情報表示

### Phase 4: 高度化
- 🔲 機械学習による予測
- 🔲 より詳細なマップ
- 🔲 複数都市対応
- 🔲 マルチプレイヤー

## 🎯 成功指標

- **プレイ時間**: 1セッション平均15分以上
- **リピート率**: 70%以上
- **的中率**: 平均6-10%（16エリアなので理論値6.25%）
- **ユーザー満足度**: 楽しい、また遊びたい

## 💡 アイデアメモ

### 追加機能案
- イベントモード（大雨警報時に特別ラウンド）
- アチーブメント（連続的中、高倍率的中など）
- フレンド対戦
- 天気情報の表示
- 過去データの可視化

### UI改善案
- より詳細な金沢地図（ランドマーク表示）
- 3Dエフェクト
- ダークモード
- カスタマイズ可能なテーマ

### ビジネスモデル案（参考）
- 広告表示
- プレミアム機能（詳細統計、予測支援）
- スポンサーシップ（地域企業）

---

**更新日**: 2025-11-17
**バージョン**: 1.0
**ステータス**: Phase 1 完了、Phase 2 準備中
